# Тестирование с помощью нагружающих акторов

С помощью нагружающих акторов вы можете запустить нагрузку изнутри системы.

На каждой ноде кластера {{ ydb-short-name }} есть актор-сервис, который получает proto с описанием нагрузки, присваивает ему Tag (если не указан явно), и создает соответствующий нагружающий актор.

Вы можете создать любое количество нагружающих акторов на любой из нод. Комбинация акторов разных [типов](#load-actor-type) позволяет запускать множество видов нагрузки. Можно комбинировать место подачи нагрузки (с одной ноды на все, со всех нод на все, со всех нод на одну), а также разные типы нагрузки (на одной ноде актор с большими редкими чтениями, на другой с частыми мелкими записями).

## Типы нагрузки {#load-actor-type}

Тип | Описание
--- | ---
`LoadStart` | нагружающий актор, подающий нагрузку от лица таблетки. Имитирует таблетку, создает себе TabletId и пишет в указанные storage-группы.
`PDiskLoadStart` | нагружающий актор для подачи write-only нагрузки на PDisk. Имитирует VDisk.
`VDiskLoadStart` | нагружающий актор для подачи нагрузки на VDisk. Имитирует DSProxy и пишет в локальный VDisk.
`PDiskReadLoadStart` | нагружающий актор для подачи read-only нагрузки на PDisk. Имитирует VDisk.
`PDiskLogLoadStart` | специальный нагружающий актор, написанный для тестирования вырезания из середины лога PDisk. Имитирует VDisk. Не является нагружающим, в первую очередь направлен на тестирование корректности.
`KeyValueLoadStart` | нагружающий актор для подачи нагрузки на KvTablet.
`KqpLoadStart` | нагружающий актор для подачи нагрузки на KQP часть и, соответственно, на весь кластер в целом. Аналогичен `ydb_cli workload`, есть два подвида - stock и kv.
`MemoryLoadStart` | специальный нагружающий актор, проверяет производительность работы памяти. Кажется, используется в math bench - иногда запускается на кластере и рисует график времени работы.
`LoadStop` | остановить нагрузку либо с конкретным тегом, либо со всеми.

## Запуск нагрузки {load-actor-start}

Вы можете запустить нагрузку следующими способами:

* .
* .

В обоих случаях необходимо создать proto-файл с текстовым описанием нагрузки. Пример файла:

```proto
message TBsTestLoadRequest {
    repeated uint32 NodeId = 1;
    optional NKikimrBlobStorage.TEvTestLoadRequest Event = 2;
};
```

### kikimr/tools/storage_perf

### kikimr/tools/kqp_load

### kikimr bin

```bash
kikimr bs-load-test -s $SERVER --protobuf "$PROTO"
```

### ui

на странице load actor

## Примеры {#load-examples}

### Запуск нагрузки {#load-examples-start}

LoadStart

### Остановка нагрузки {load-examples-stop}

LoadStop
