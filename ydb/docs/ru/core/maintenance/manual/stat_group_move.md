# Миграция статической группы

## Миграция статической группы между двумя хостами кластера
**Данная процедура может потребоваться в случае, когда текущий хост кластера полностью выводится из эксплуатации.**

{% note alert %}

Процедура является потенциально опасной, будьте внимательны.

{% endnote %}

Для замены одной ноды **статической** группы в кластере на другую, необходимо проделать следующие действия:

Предположим осуществляется миграция части статической группы с ноды с id:1 на ноду с id:10 и у нас уже нода с id:10 описана в конфигурационном файле `config.yaml`

Шаги:
* Остановить процесс `ydb server` на ноде, с которой будет увезен кусок статической группы.
* Отредактировать конфигурационный файл `config.yaml`, поменяв в секции настройки статической группы node_id сервера, с которого будет переноситься статическая группа на node_id конечного сервера:
```yaml
blob_storage_config:
  service_set:
    ...
        - vdisk_locations:
          - node_id: 1                          #-> меняем на 10
            path: /dev/vda                      #-> меняем имя диска, если оно отличается
            pdisk_category: SSD                 #-> меняем категорию диска, если она отличается (SSD/ROT/NVME)
        - vdisk_locations:
    ...
```
* Нужно выложить измененный конфигурационный файл ydb на все ноды кластера
* Провести процесс [роллинг-рестарта](node_restarting.md) `ydb server` на всех storage нодах кластера
* Убедиться, что виртуальный диск статической группы появился и реплицируется на целевом физическом диске с помощью [мониторинга](#stat_group_web_mon)
* Провести процесс [роллинг-рестарта](node_restarting.md) динамических нод ydb (всех)

### Web monitoring статической группы {#stat_group_web_mon}
Основное описание Web monitoring'а ydb: [Web Monitoring](../embedded_monitoring/ydb_monitoring.md)

1. Проверить статус статической группы можно перейдя на вкладку `Storage` (слева в панели). По умолчанию открывается список групп с проблемами.
2. В появившейся поисковой строке (Group ID, Pool name) ввести "static", если результат пустой, значит со статической группой все в порядке.
3. Если в выдаче видно группу **static**, то нужно проверить статус **Vdisk**'ов (справа).
4. В статусах (цветах) Vdisk'ов допускаются **зеленый** и **синий**(репликация в процессе).
5. Если присутствует красный цвет в статусе Vdisk'а, то нужно навести на него курсор и попытаться понять проблему по текстовому описанию
