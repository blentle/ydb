# Миграция State Storage

## Миграция State Storage с одного хоста кластера на другой
**Данная процедура может потребоваться в случае, когда текущий хост кластера полностью выводится из эксплуатации.**

{% note alert %}

Процедура является потенциально опасной, будьте внимательны.

{% endnote %}

Если у вас появилась потребность перевезти часть `State Storage` с одной ноды кластера на другую, то нужно выполнить
действия, описанные ниже (предполагаем, что новая нода с id:10 уже заведена в `config.yaml`).

Перевоз части `State Storage` с ноды с id:1 на ноду с id:10:
* Погасить процессы `ydb server` на нодах с id:1 и id:10
* В конфигурационном файле `config.yaml` сделать изменения в секции `state_storage`
```
  state_storage:
  - ring:
      node: [1, 2, 3, 4, 5, 6...] <массив узлов State Storage>
      nto_select: <количество реплик данных в State Storage>
    ssid: 1
```
меняем `1` на `10` и получаем:
```
  state_storage:
  - ring:
      node: [10, 2, 3, 4, 5, 6...] <массив узлов State Storage>
      nto_select: <количество реплик данных в State Storage>
    ssid: 1
```
* Выкладываем измененный `config.yaml` на все ноды кластера, включая динамические (обслуживающие базы кластера)
* Перезапускаем [rolling-restart'ом](node_restarting.md) процессы `ydb server` на всех нодах (включая динамические), кроме нод с id:1 и id:10
* Запускаем процессы `ydb server` на нодах с id:1 и id:10
---
